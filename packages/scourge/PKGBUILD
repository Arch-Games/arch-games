# Contributor: Angelo Theodorou <encelo@users.sourceforge.net>

pkgname=scourge
pkgver=0.21.1
pkgrel=1
pkgdesc="A roguelike game with a 3d graphical front-end"
url="http://scourgeweb.org"
arch=('i686' 'x86_64')
license=('GPL')
depends=('sdl_image' 'sdl_mixer' 'sdl_net' 'sdl_ttf' 'mesa')
source=(http://downloads.sourceforge.net/sourceforge/scourge/$pkgname-$pkgver.src.tar.gz
        http://downloads.sourceforge.net/sourceforge/scourge/$pkgname-$pkgver.data.tar.gz
        scourge.patch)

md5sums=()

build() {

  #Patch, build and install the package
  cd $srcdir/scourge
  patch -Np0 -i $srcdir/scourge.patch || return 1
  autoreconf -i
  ./configure --prefix=/usr --with-data-dir=/usr/share/scourge --enable-stencil-buffer
  make || return 1
  make DESTDIR=$pkgdir install

  #Install the game data
  install -d -m755 $pkgdir/usr/share/
  chmod -R go+r $srcdir/scourge_data
  chmod go+x $srcdir/scourge_data/models/character/gladius/
  cp -pr $srcdir/scourge_data $pkgdir/usr/share/scourge

  #Remove garbage
  rm -r $pkgdir/usr/share/scourge/world $pkgdir/usr/share/scourge/mod/default/models/

}

# vim:set ts=2 sw=2 et:

