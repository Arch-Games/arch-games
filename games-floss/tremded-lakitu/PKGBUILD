# Contributor: Daenyth <Daenyth+Arch AT gmail DOT com>
pkgname=tremded-lakitu
pkgver=5.22
pkgrel=1
pkgdesc="The tremulous server patched with lakitu's game.qvm"
arch=(i686)
url="http://www.mercenariesguild.net/patches/index.php?project=2&do=index"
license=('GPL')
depends=('sdl' 'openal' 'screen')
options=(emptydirs )
backup=(srv/tremulous/screended)
install="$pkgname.install"
source=("http://source.mercenariesguild.net/lakitu7-qvm/tags/Release_$pkgver.tar.gz?view=tar"
        'http://downloads.sourceforge.net/tremulous/tremulous-1.1.0.zip'
        'lakitu_qvm.pdf' 'lakitu_qvm.txt'
        'screended' 'tremded.usrbin')

build() {
  cd $srcdir/Release_$pkgver
  make || return 1

  # tremded binary and game.qvm
  cd build/release-linux-x86
  install -Dm755 tremded.x86 $pkgdir/srv/tremulous/tremded            
  install -Dm644 base/vm/game.qvm $pkgdir/srv/tremulous/base/vm/game.qvm 

  # Required data files, including the basic map set
  cd $srcdir/tremulous
  install -Dm644 base/* $pkgdir/srv/tremulous/base

  # Stuff
  install -d $pkgdir/srv/tremulous/.tremulous/base
  install -d $pkgdir/usr/share/tremded
  install -Dm644 $srcdir/lakitu_qvm.{pdf,txt} $pkgdir/usr/share/tremded/
  install -Dm755 $srcdir/tremded.usrbin $pkgdir/usr/bin/tremded
  install -Dm750 $srcdir/screended $pkgdir/srv/tremulous/screended

}
# vim:set ts=2 sw=2 et:
