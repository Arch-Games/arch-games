# Contributor: rabyte <rabyte__gmail>

pkgname=widelands
pkgver=12
pkgrel=1
pkgdesc="A realtime-strategy game inspired by Settlers II"
arch=('i686' 'x86_64')
url="http://www.widelands.org/"
license=('GPL2')
depends=('sdl_mixer>=1.2.6' 'sdl_image' 'sdl_net' 'sdl_ttf>=2' 'sdl_gfx' 'gcc-libs')
makedepends=('scons>=0.97' 'boost')
source=(http://downloads.sourceforge.net/$pkgname/$pkgname-build-$pkgver-source.tar.bz2 \
	$pkgname.desktop)
md5sums=('1b551106e0f613f63abd7e6bdc9cebf6' '4778247d832b78702746f3116e61156b')

build() {
  cd $srcdir/$pkgname
  sed "s#/games##" -i src/wlapplication.cc
  scons prefix=/usr bindir=bin datadir=share/widelands localedir=share/widelands/locale \
	extra_compile_flags="${CXXFLAGS}" || return 1
  utils/buildlocale.py || return 1
  install -m755 -D widelands $pkgdir/usr/bin/widelands
  mkdir -p $pkgdir/usr/share/widelands
  cp -rf campaigns/ fonts/ locale/ maps/ music/ pics/ sound/ tribes/ txts/ worlds/ \
	$pkgdir/usr/share/widelands/
  install -m644 -D pics/wl-ico-128.png $startdir/pkg/usr/share/pixmaps/widelands.png
  install -m644 -D ../widelands.desktop $startdir/pkg/usr/share/applications/widelands.desktop
}
