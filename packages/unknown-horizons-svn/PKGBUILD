# Contributor: Thomas Kinnen <thomas.kinnen@gmail.com>

pkgname=unknown-horizons-svn
pkgver=2458
pkgrel=2
pkgdesc="A 2D realtime strategy simulation with an emphasis on economy and city building"
arch=('i686' 'x86_64')
url="http://unknown-horizons.org/"
license=('GPL' 'CCPL')
depends=('fife-svn' 'python' 'python-simplejson')
makedepends=('subversion')
provides=('unknown-horizons')
conflicts=('unknown-horizons' 'openanno')
source=()
md5sums=()

_svntrunk=svn://unknown-horizons.org/unknown-horizons/trunk 
_svnmod=unknown-horizons

build() {
  cd $srcdir
  [ -d $_svnmod/.svn ] && {
	cd $_svnmod
	svn up
	cd ..
  } || {
	svn co $_svntrunk $_svnmod
  }
  msg "SVN checkout done or server timeout"

  cd $_svnmod

  msg "Starting make..."
  python setup.py install --home=$pkgdir/usr
  mkdir -p $pkgdir/usr/lib/python2.6/site-packages/
  mv $pkgdir/usr/lib/python/* $pkgdir/usr/lib/python2.6/site-packages/
  rm -rf $pkgdir/usr/lib/python
  find $pkgbuild -depth -type d -name ".svn" -exec rm -rf {} \;
}
