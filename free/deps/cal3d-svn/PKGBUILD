# Contributor: Hussam Al-Tayeb <ht990332@gmail.com>

pkgname=cal3d-svn
pkgver=495
pkgrel=1
pkgdesc="A skeletal-based 3D character animation library"
url="https://gna.org/projects/cal3d"
arch=('i686' 'x86_64')
license=(GPL2)
makedepends=('subversion')
provides=('cal3d')
conflicts=('cal3d')
options=(!libtool)
source=(cal3d.patch)
md5sums=('d2ef9bbc133c0f5cccc55387df12851c')
     
_svntrunk=svn://svn.gna.org/svn/cal3d/trunk/cal3d
_svnmod=cal3d
     
build() {

  #Grab the sources with svn
  cd $srcdir
  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver) || return 1
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod || return 1
  fi
  msg "SVN checkout done or server timeout"
  msg "Starting make..."
  rm -r $srcdir/$_svnmod-build
  cp -r $srcdir/$_svnmod $srcdir/$_svnmod-build
  cd $srcdir/$_svnmod-build

  #Patching building and installing the source
  patch -Np0 -i $srcdir/cal3d.patch || return 1
  sed -i 's/AM_USE_UNITTESTCPP/# AM_USE_UNITTESTCPP/' configure.in || return 1
  autoreconf --install --force
  ./configure --prefix=$pkgdir/usr
  make || return 1
  make install 
  
}

# vim:set ts=2 sw=2 et:
